<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13&nbsp; Data validation ‚Äì Reproducible and Trustworthy Workflows for Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lectures/140-intro-to-testing-code.html" rel="next">
<link href="../parts/data-testing.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
div.callout-definition.callout {
  border-left-color: pink;
}
div.callout-definition.callout-style-default > .callout-header {
  background-color: rgb(from pink r g b / 13%);
}
div.callout-definition .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-definition.callout-style-default .callout-icon::before, div.callout-definition.callout-titled .callout-icon::before {
  content: 'üìù';
  background-image: none;
}
div.callout-activity.callout {
  border-left-color: blue;
}
div.callout-activity.callout-style-default > .callout-header {
  background-color: rgb(from blue r g b / 13%);
}
div.callout-activity .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-activity.callout-style-default .callout-icon::before, div.callout-activity.callout-titled .callout-icon::before {
  content: 'üß©';
  background-image: none;
}
div.callout-relevance-project.callout {
  border-left-color: orange;
}
div.callout-relevance-project.callout-style-default > .callout-header {
  background-color: rgb(from orange r g b / 13%);
}
div.callout-relevance-project .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-relevance-project.callout-style-default .callout-icon::before, div.callout-relevance-project.callout-titled .callout-icon::before {
  content: 'üíª';
  background-image: none;
}
div.callout-exercise.callout {
  border-left-color: green;
}
div.callout-exercise.callout-style-default > .callout-header {
  background-color: rgb(from green r g b / 13%);
}
div.callout-exercise .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-exercise.callout-style-default .callout-icon::before, div.callout-exercise.callout-titled .callout-icon::before {
  content: 'üèãÔ∏è';
  background-image: none;
}
</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../parts/data-testing.html">Data Validation</a></li><li class="breadcrumb-item"><a href="../lectures/130-data-validation.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data validation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Reproducible and Trustworthy Workflows for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/UBC-DSCI/reproducible-and-trustworthy-workflows-for-data-science/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/010-intro-to-ds-workflows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">How do reproducible and trustworthy workflows impact data science?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/020-intro-to-bash.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to the Bash Shell</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/version-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Version Control</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/030-ssh-for-authentication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">SSH for authentication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/040-version-control-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Version control (for transparency and collaboration) I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/050-version-control-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Version control (for transparency and collaboration) II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/060-version-control-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Project management using GitHub</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/projects-envs-containers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects, Environments, and Containers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/070-filenames-project-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Filenames and data science project organization, Integrated development environments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/080-virtual-environments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Virtual environments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/090-conda-lock.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Conda lock: reproducible lock files for conda environments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/100-containerization-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to containerization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/110-containerization-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Using and running containers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/120-containerization-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Customizing and building containers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/data-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Validation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/130-data-validation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/140-intro-to-testing-code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction to testing code for data science</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/automation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/150-scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Non-interactive scripts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/160-reproducible-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Reproducible reports</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/170-pipelines-scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data analysis pipelines with scripts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/180-pipelines-make.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Data analysis pipelines with GNU Make</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/packaging-ci-cd-publish.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages and Continuous Integration + Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/190-packaging-and-documenting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Packaging and documenting code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/200-continuous-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Automated testing and continuous integration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/210-deploy-and-publish.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Deploying and publishing packages</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/licenses-copyright-wrapup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wrap Up</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/220-licenses-and-copyright.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Copyright and licenses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/230-reproducibility-wrap-up.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Workflows for reproducibile and trustworthy data science wrap-up</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/900-functions-in-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Defining functions in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/910-functions-in-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Defining functions in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/920-reproducible-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Reproducible reports</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#the-role-of-data-validation-in-data-analysis" id="toc-the-role-of-data-validation-in-data-analysis" class="nav-link" data-scroll-target="#the-role-of-data-validation-in-data-analysis"><span class="header-section-number">13.1</span> The role of data validation in data analysis</a></li>
  <li><a href="#where-does-data-validation-fit-in-data-analysis" id="toc-where-does-data-validation-fit-in-data-analysis" class="nav-link" data-scroll-target="#where-does-data-validation-fit-in-data-analysis"><span class="header-section-number">13.2</span> Where does data validation fit in data analysis?</a></li>
  <li><a href="#data-validation-checks" id="toc-data-validation-checks" class="nav-link" data-scroll-target="#data-validation-checks"><span class="header-section-number">13.3</span> Data validation checks</a>
  <ul class="collapse">
  <li><a href="#data-validation-checklist" id="toc-data-validation-checklist" class="nav-link" data-scroll-target="#data-validation-checklist"><span class="header-section-number">13.3.1</span> Data validation checklist</a></li>
  </ul></li>
  <li><a href="#introduction-to-pythons-pandera" id="toc-introduction-to-pythons-pandera" class="nav-link" data-scroll-target="#introduction-to-pythons-pandera"><span class="header-section-number">13.4</span> Introduction to Python‚Äôs Pandera</a>
  <ul class="collapse">
  <li><a href="#validating-data-with-pandera" id="toc-validating-data-with-pandera" class="nav-link" data-scroll-target="#validating-data-with-pandera"><span class="header-section-number">13.4.1</span> Validating data with Pandera</a></li>
  <li><a href="#dataframe-schema" id="toc-dataframe-schema" class="nav-link" data-scroll-target="#dataframe-schema"><span class="header-section-number">13.4.2</span> Dataframe Schema</a></li>
  <li><a href="#data-validation" id="toc-data-validation" class="nav-link" data-scroll-target="#data-validation"><span class="header-section-number">13.4.3</span> Data validation</a></li>
  <li><a href="#handling-invalid-data" id="toc-handling-invalid-data" class="nav-link" data-scroll-target="#handling-invalid-data"><span class="header-section-number">13.4.4</span> Handling invalid data</a></li>
  <li><a href="#dropping-invalid-observations" id="toc-dropping-invalid-observations" class="nav-link" data-scroll-target="#dropping-invalid-observations"><span class="header-section-number">13.4.5</span> Dropping invalid observations</a></li>
  <li><a href="#writing-data-validation-logs" id="toc-writing-data-validation-logs" class="nav-link" data-scroll-target="#writing-data-validation-logs"><span class="header-section-number">13.4.6</span> Writing data validation logs</a></li>
  </ul></li>
  <li><a href="#the-data-validation-ecosystem" id="toc-the-data-validation-ecosystem" class="nav-link" data-scroll-target="#the-data-validation-ecosystem"><span class="header-section-number">13.5</span> The data validation ecosystem</a>
  <ul class="collapse">
  <li><a href="#deep-checks" id="toc-deep-checks" class="nav-link" data-scroll-target="#deep-checks"><span class="header-section-number">13.5.1</span> Deep Checks</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../parts/data-testing.html">Data Validation</a></li><li class="breadcrumb-item"><a href="../lectures/130-data-validation.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data validation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data validation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<ol type="1">
<li>Explain why it is important to validate data used in a data analysis project, and give examples of consequences that might occur with invalid data.</li>
<li>Discuss where data validation should happen in a data analysis project.</li>
<li>List the major checks that should be performed when validating data for data analysis, and justiy why they should be used.</li>
<li>Use the Python Pandera package to create data schema for checking and to validate data.</li>
<li>Use the Python Pandera package to drop invalid rows.</li>
<li>List other commonly used data validation packages for Python and R.</li>
</ol>
</section>
<section id="the-role-of-data-validation-in-data-analysis" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="the-role-of-data-validation-in-data-analysis"><span class="header-section-number">13.1</span> The role of data validation in data analysis</h2>
<p>Regardless of the statistical question you are asking in your data analysis project, you will be reading in data to Python or R to visualize and/or model. If there are data quality issues, these issues will be propagated and will become data visualization and/or data model issues. This may remind you of an old saying from the mid 20th century:</p>
<p><em>‚ÄúGarbage in, garbage out.‚Äù</em></p>
<p>Thus, to ensure that our data visualization and/or modeling results are correct, robust and of high quality, it is important that we validate, or check, the quality of the data before we perform such analyses. It is important to note that data validation is not sufficient for a correct, robust and of high quality analysis, but it is necessary.</p>
</section>
<section id="where-does-data-validation-fit-in-data-analysis" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="where-does-data-validation-fit-in-data-analysis"><span class="header-section-number">13.2</span> Where does data validation fit in data analysis?</h2>
<p>If we are going to validate, or check, our data for our data analysis, at what stage in our analysis should we do this? At a minimum, this should be done after data sourcing or extraction, but before data is used in any analysis. In the context of a project where data splitting is needed (e.g., predictive questions using supervised machine learning), this should be done before the data is split.</p>
<!-- add figure of a data analysis pipeline and an arrow pointing to where this should be done -->
<p>If there are larger, more severe consequences of the data analysis being incorrect (e.g., autonomous driving), and the data undergoes file input/output as it is passed through a series of scripts, it may be advisable for data validation, checking to be done each time the data is read. This can be made more efficient by modularizing the data validation/checking into functions. This likely should be done however, regardless of the application of the data analysis, as modularizing the data validation/checking into functions also allows this code to be tested to ensure it is correct, and that invalid data is handled as intended (more on this in the testing chapter later in this book).</p>
<p>One note of caution for where to perform data validation checks in data analysis where data splitting is needed (e.g., splitting data into a training and test set for answering predictive questions) is that you want to be sure that the data validation checks do not cause any data leakage between the split data sets. For example, when checking for anomalous correlations between the target/response variable and features/explanatory variables, when attempting to answer a predictive question, it would be important to not use the entire data set. This is because using the entire dataset for such checks could inadvertently reveal patterns, distributions, or relationships from the test set ‚Äì which may impact the analyst‚Äôs decisions/choices when performing feature and model selection. Given that, data validation checks like this should initially only be done on the training set. It may make sense to apply this data validation check also to the test set, but only after finalizing the feature and model selection.</p>
</section>
<section id="data-validation-checks" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="data-validation-checks"><span class="header-section-number">13.3</span> Data validation checks</h2>
<p>What kind of data validation, or checks, should be done to ensure the data is of high quality? This does somewhat depend on the type of data being used (e.g., tabular, images, language). Here we will list validations, or checks, that should be done on tabular data. If the reader is interested in validations, or checks, that should be done for more complex data types (e.g., images, language) we refer them to the deepchecks checks gallery for data integrity:</p>
<ul>
<li><a href="https://docs.deepchecks.com/stable/vision/auto_checks/data_integrity/index.html">deepchecks image/vision data integrity checks</a></li>
<li><a href="https://docs.deepchecks.com/stable/nlp/auto_checks/data_integrity/index.html">deepchecks language/NLP data integrity checks</a></li>
</ul>
<section id="data-validation-checklist" class="level3" data-number="13.3.1">
<h3 data-number="13.3.1" class="anchored" data-anchor-id="data-validation-checklist"><span class="header-section-number">13.3.1</span> Data validation checklist</h3>
<ul class="task-list">
<li><label><input type="checkbox">Correct data file format<sup>2</sup></label></li>
<li><label><input type="checkbox">Correct column names<sup>1</sup></label></li>
<li><label><input type="checkbox">No empty observations<sup>4</sup></label></li>
<li><label><input type="checkbox">Missingness not beyond expected threshold<sup>1,2</sup></label></li>
<li><label><input type="checkbox">Correct data types in each column<sup>1,2</sup></label></li>
<li><label><input type="checkbox">No duplicate observations<sup>1,2</sup></label></li>
<li><label><input type="checkbox">No outlier or anomalous values<sup>1,2,3</sup></label></li>
<li><label><input type="checkbox">Correct category levels (i.e., no string mismatches or single values)<sup>1</sup></label></li>
<li><label><input type="checkbox">Target/response variable follows expected distribution<sup>1</sup></label></li>
<li><label><input type="checkbox">No anomalous correlations between target/response variable and features/explanatory variables<sup>1</sup></label></li>
<li><label><input type="checkbox">No anomalous correlations between features/explanatory variables<sup>1</sup></label></li>
</ul>
<section id="checklist-references" class="level4">
<h4 class="anchored" data-anchor-id="checklist-references">Checklist references</h4>
<ol type="1">
<li><a href="https://www.jmlr.org/papers/volume23/22-0281/22-0281.pdf">Chorev et al (2022). Deepchecks: A Library for Testing and Validating Machine Learning Models and Data. Journal of Machine Learning Research 23 1-6</a></li>
<li><a href="https://microsoft.github.io/code-with-engineering-playbook/machine-learning/testing-data-science-and-mlops-code/">Microsoft Industry Solutions Engineering Team (2024). Engineering Fundamentals Playbook: Testing Data Science and MLOps Code Chapter</a></li>
<li><a href="https://research.google/pubs/the-ml-test-score-a-rubric-for-ml-production-readiness-and-technical-debt-reduction/">Breck et al (2017). The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction. Proceedings of IEEE Big Data 1123-1132</a></li>
<li><a href="https://research.google/pubs/the-data-linter-lightweight-automated-sanity-checking-for-ml-data-sets/">Hynes et al (2017). The data linter: Lightweight, automated sanity checking for ml data sets. In NIPS MLSys Workshop 1(2017) 5</a></li>
</ol>
</section>
</section>
</section>
<section id="introduction-to-pythons-pandera" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="introduction-to-pythons-pandera"><span class="header-section-number">13.4</span> Introduction to Python‚Äôs Pandera</h2>
<p>Python‚Äôs <a href="https://pandera.readthedocs.io/en/stable/">Pandera</a> is a package designed to make data validation/checking of dataframes and other dataframe-like objects easy, readable and robust. Key features of Pandera that we will discuss include:</p>
<ul>
<li>The ability to define a data schema and use it to validate dataframes and other dataframe-like objects</li>
<li>Check the types and properties of columns</li>
<li>Perform statistical validation of data</li>
<li>Execute all validation in a lazy manner, so that validation rules are executed before raising an error</li>
<li>Handle invalid data in a number of ways, including throwing errors, writing data validation logs, and dropping observations that are invalid</li>
</ul>
<section id="validating-data-with-pandera" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="validating-data-with-pandera"><span class="header-section-number">13.4.1</span> Validating data with Pandera</h3>
<p>In the simplest use case, Pandera can be use to validate data by first defining an instance of the <code>DataFrameSchema</code> class. This object specifies the properties we expect (and thus would like to check) for our dataframe index and columns. After the <code>DataFrameSchema</code> instance has been created and defined, the <code>DataFrameSchema.validate</code> method can be applied to a <code>pandas.DataFrame</code> instance to validate, or check, all of the properties we specified that we expect for our dataframe index and columns in the <code>DataFrameSchema</code> instance.</p>
</section>
<section id="dataframe-schema" class="level3" data-number="13.4.2">
<h3 data-number="13.4.2" class="anchored" data-anchor-id="dataframe-schema"><span class="header-section-number">13.4.2</span> Dataframe Schema</h3>
<p>When we create an instance of the <code>DataFrameSchema</code> class, we can specify the the properties we expect (and thus would like to check) for our dataframe index and columns.</p>
<section id="creating-pa.dataframeschema-and-setting-required-columns" class="level4">
<h4 class="anchored" data-anchor-id="creating-pa.dataframeschema-and-setting-required-columns">Creating <code>pa.DataFrameSchema</code> and setting required columns</h4>
<p>To create an instance of the <code>DataFrameSchema</code> class we first import the Pandera package using the alias <code>pa</code>, and then the function <code>pa.DataFrameSchema</code>. Below we demonstrate creating an instance of the <code>DataFrameSchema</code> class for the first two columns of the <a href="https://archive.ics.uci.edu/dataset/17/breast+cancer+wisconsin+diagnostic">Wisconsin Breast Cancer data set</a> from the <a href="https://archive.ics.uci.edu/">UCI Machine Learning Repository</a> (Dua and Graff 2017).</p>
<div id="bb4ef5bf" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandera <span class="im">as</span> pa</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>By default all columns listed are required to be in the dataframe for it to pass validation. If we wanted to make a column optional, we would set <code>required=False</code> in the column constructor.</p>
</div>
</div>
</section>
<section id="specifying-column-types" class="level4">
<h4 class="anchored" data-anchor-id="specifying-column-types">Specifying column types</h4>
<p>We can specify the type we expect each column to be, by writing the type as the first argument to <code>pa.Column</code>. Possible values include:</p>
<ul>
<li>a string alias, as long as it is recognized by pandas.</li>
<li>a python type: <code>int</code>, <code>float</code>, <code>double</code>, <code>bool</code>, <code>str</code></li>
<li>a <code>numpy</code> data type</li>
<li>a pandas extension type: it can be an instance (e.g <code>pd.CategoricalDtype(["a", "b"])</code>) or a class (e.g <code>pandas.CategoricalDtype</code>) if it can be initialized with default values.</li>
<li>a pandera <code>DataType</code>: it can also be an instance or a class.</li>
</ul>
<p>See the Pandera <a href="https://pandera.readthedocs.io/en/stable/dtype_validation.html#dtype-validation">Data Type Validation docs</a> for details beyond what we present here.</p>
<p>If we continue our example from above, we can specify that we expect the <code>class</code> column to be a string and the <code>mean_radius</code> column to be a float as shown below:</p>
<div id="d2cc0c96" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missingnessnull-values" class="level4">
<h4 class="anchored" data-anchor-id="missingnessnull-values">Missingness/null values</h4>
<p>By default Column objects assume there should be no null/missing values. If you want to allow missing values, you need to set <code>nullable=True</code> in the column constructor. We demonstrate that below for the <code>mean_radius</code> column of our working example. Note that we do not set this to be true for our class column as we likely do not want to be working with observations where the target/response variable is missing.</p>
<div id="0235dbf4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you wanted to allow a percentage of the values for a particular column to be allowed to be missing, then you could do this by writing a lambda function in a call to <code>pa.Check</code> in the column constructor. We show an example of that below where allow up to 5% of the <code>mean_radius</code> column values to be missing.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is putting the cart a bit before the horse here, as we have not yet introduced <code>pa.Check</code>. We will do that in the next section, so please fell free to skip this and come back to this example after you have read that.</p>
</div>
</div>
<div id="69e897ee" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                pa.Check(<span class="kw">lambda</span> s: s.isna().mean() <span class="op">&lt;=</span> <span class="fl">0.05</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                    element_wise<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                    error<span class="op">=</span><span class="st">"Too many null values in 'mean_radius' column."</span>), </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Above we have created our custom check on-the-fly using a <code>lambda</code> function. We could do this here because the check was fairly simple. If we needed a custom check that was more complex (e.g., needs to generate data as part of the check) then we would be better to register our custom check. For situations like this, we direct the reader to the <a href="https://pandera.readthedocs.io/en/stable/extensions.html#extensions">Pandera Extension docs</a>.</p>
</div>
</div>
</section>
<section id="checking-values-in-columns" class="level4">
<h4 class="anchored" data-anchor-id="checking-values-in-columns">Checking values in columns</h4>
<p>Pandera has a function <code>pa.Check</code> that is useful for checking values within columns. For any type of data, there is usually some reasonable range of values that we would expect. These usually come from domain knowledge about the data. For example, a column named <code>age</code> for a data set about adult human patients age in years should probably be an integer and have a range of values between 18 and 122 (<a href="https://en.wikipedia.org/wiki/List_of_the_verified_oldest_people#cite_note-5">the oldest person whose age has ever been independently verified</a>). To specify a check for a range like this, we can use the <code>pa.Check.between</code> method. We demonstrate how to do this below with our working example to check that the <code>mean_radius</code> values are between 5 and 45, inclusive.</p>
<div id="0f2336bf" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, pa.Check.between(<span class="dv">5</span>, <span class="dv">45</span>), nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In our working example, we might also want to check that the <code>class</code> column only contains the strings we think are acceptable for our category label, which would be <code>"Benign"</code> and <code>"Malignant"</code>. We can do this using the <code>pa.Check.isin</code> method, which we demonstrate below:</p>
<div id="e0564c64" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>, pa.Check.isin([<span class="st">"Benign"</span>, <span class="st">"Malignant"</span>])),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, pa.Check.between(<span class="dv">5</span>, <span class="dv">45</span>), nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are many more built-in <code>pa.Check</code> methods. A list can be found in the Pandera <code>Check</code> API docs: - <a href="https://pandera.readthedocs.io/en/stable/reference/generated/pandera.api.checks.Check.html#pandera.api.checks.Check" class="uri">https://pandera.readthedocs.io/en/stable/reference/generated/pandera.api.checks.Check.html#pandera.api.checks.Check</a></p>
<p>If there is a check you wish to do that is not part of the Pandera <code>Check</code> API you have two options:</p>
<ol type="1">
<li>Use a <code>lambda</code> function with boolean logic inside of <code>pa.Check</code> (good for simple checks, similar to the percentage of missingness in the section above), or</li>
<li>Register our custom check (see how to in <a href="https://pandera.readthedocs.io/en/stable/extensions.html#extensions">Pandera Extension docs</a>)</li>
</ol>
</section>
<section id="duplicates" class="level4">
<h4 class="anchored" data-anchor-id="duplicates">Duplicates</h4>
<p>Pandera does not yet have a method to check for duplicate rows in a dataframe, however, you can apply <code>pa.Check</code> to the entire data frame using a <code>lambda</code> function with boolean logic. Thus, we can easily apply Pandas <code>duplicated</code> function in a Lambda Function to check for duplicate rows. We show an example of that below:</p>
<div id="2f1240ba" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>, pa.Check.isin([<span class="st">"Benign"</span>, <span class="st">"Malignant"</span>])),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, pa.Check.between(<span class="dv">5</span>, <span class="dv">45</span>), nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    checks<span class="op">=</span>[</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>df.duplicated().<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Duplicate rows found."</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="empty-observations" class="level4">
<h4 class="anchored" data-anchor-id="empty-observations">Empty observations</h4>
<p>Similar to duplicates, there is no Pandera function for this. So again we can use <code>pa.Check</code> applied to the entire data frame using a <code>lambda</code> function with boolean logic.</p>
<div id="a7febb7c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>, pa.Check.isin([<span class="st">"Benign"</span>, <span class="st">"Malignant"</span>])),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, pa.Check.between(<span class="dv">5</span>, <span class="dv">45</span>), nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    checks<span class="op">=</span>[</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>df.duplicated().<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Duplicate rows found."</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>(df.isna().<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)).<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Empty rows found."</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-validation" class="level3" data-number="13.4.3">
<h3 data-number="13.4.3" class="anchored" data-anchor-id="data-validation"><span class="header-section-number">13.4.3</span> Data validation</h3>
<p>Once we have specified our the properties we expect (and thus would like to check) for our dataframe index and columns by creating an instance of <code>pa.DataFrameSchema</code>, we can use the <code>pa.DataFrameSchema.validate</code> method on a dataframe to check if the dataframe is valid considering the schema we specified.</p>
<p>To demonstrate this, below we create two very simple versions of the Wisconsin Breast Cancer data set. One which we expect to pass our validation checks, and one where we introduce three data anomalies that should cause some checks to fail.</p>
<p>First we create two data frames:</p>
<div id="7bda0339" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>valid_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"class"</span>: [<span class="st">"Benign"</span>, <span class="st">"Benign"</span>, <span class="st">"Malignant"</span>],</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean_radius"</span>: [<span class="fl">6.0</span>, <span class="fl">31.2</span>, <span class="fl">22.8</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>invalid_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"class"</span>: [<span class="st">"Benign"</span>, <span class="st">"Benign"</span>, <span class="st">"benign"</span>, <span class="st">"Malignant"</span>],</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean_radius"</span>: [<span class="fl">6.0</span>, <span class="fl">6.0</span>, <span class="fl">31.2</span>, <span class="op">-</span><span class="dv">9999</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let‚Äôs see what happens when we apply <code>pa.DataFrameSchema.validate</code> to our valid data:</p>
<div id="907274b2" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>schema.validate(valid_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">mean_radius</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Benign</td>
<td>6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Benign</td>
<td>31.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Malignant</td>
<td>22.8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It returns a dataframe and does not throw an error. Excellent! What happens when we pass clearly invalid data?</p>
<div id="4a54df0c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>schema.validate(invalid_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">SchemaError</span>                               Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[11], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">schema</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">invalid_data</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/pandas/container.py:126</span>, in <span class="ansi-cyan-fg">DataFrameSchema.validate</span><span class="ansi-blue-fg">(self, check_obj, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    114</span>     check_obj <span style="color:rgb(98,98,98)">=</span> check_obj<span style="color:rgb(98,98,98)">.</span>map_partitions(  <span style="font-style:italic;color:rgb(95,135,135)"># type: ignore [operator]</span>
<span class="ansi-green-fg ansi-bold">    115</span>         <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_validate,
<span class="ansi-green-fg ansi-bold">    116</span>         head<span style="color:rgb(98,98,98)">=</span>head,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    122</span>         meta<span style="color:rgb(98,98,98)">=</span>check_obj,
<span class="ansi-green-fg ansi-bold">    123</span>     )
<span class="ansi-green-fg ansi-bold">    124</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> check_obj<span style="color:rgb(98,98,98)">.</span>pandera<span style="color:rgb(98,98,98)">.</span>add_schema(<span style="color:rgb(0,135,0)">self</span>)
<span class="ansi-green-fg">--&gt; 126</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    127</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">check_obj</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    128</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    129</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    130</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    131</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    132</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    133</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">inplace</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    134</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/pandas/container.py:156</span>, in <span class="ansi-cyan-fg">DataFrameSchema._validate</span><span class="ansi-blue-fg">(self, check_obj, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    147</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_is_inferred:
<span class="ansi-green-fg ansi-bold">    148</span>     warnings<span style="color:rgb(98,98,98)">.</span>warn(
<span class="ansi-green-fg ansi-bold">    149</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">This </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span style="color:rgb(0,135,0)">type</span>(<span style="color:rgb(0,135,0)">self</span>)<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)"> is an inferred schema that hasn</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">t been </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    150</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">modified. It</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">s recommended that you refine the schema </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    153</span>         <span style="font-weight:bold;color:rgb(215,95,95)">UserWarning</span>,
<span class="ansi-green-fg ansi-bold">    154</span>     )
<span class="ansi-green-fg">--&gt; 156</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">get_backend</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    157</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    158</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">schema</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    159</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    160</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    161</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    162</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    163</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    164</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">inplace</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    165</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/container.py:105</span>, in <span class="ansi-cyan-fg">DataFrameSchemaBackend.validate</span><span class="ansi-blue-fg">(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    100</span> components <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>collect_schema_components(
<span class="ansi-green-fg ansi-bold">    101</span>     check_obj, schema, column_info
<span class="ansi-green-fg ansi-bold">    102</span> )
<span class="ansi-green-fg ansi-bold">    104</span> <span style="font-style:italic;color:rgb(95,135,135)"># run the checks</span>
<span class="ansi-green-fg">--&gt; 105</span> error_handler <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">run_checks_and_handle_errors</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    106</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">error_handler</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    107</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">schema</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    108</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    109</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">column_info</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    110</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    111</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">components</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    112</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    113</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    114</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    115</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    116</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    118</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> error_handler<span style="color:rgb(98,98,98)">.</span>collected_errors:
<span class="ansi-green-fg ansi-bold">    119</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">getattr</span>(schema, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">drop_invalid_rows</span><span style="color:rgb(175,0,0)">"</span>, <span style="font-weight:bold;color:rgb(0,135,0)">False</span>):

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/container.py:180</span>, in <span class="ansi-cyan-fg">DataFrameSchemaBackend.run_checks_and_handle_errors</span><span class="ansi-blue-fg">(self, error_handler, schema, check_obj, column_info, sample, components, lazy, head, tail, random_state)</span>
<span class="ansi-green-fg ansi-bold">    169</span>         <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg ansi-bold">    170</span>             error <span style="color:rgb(98,98,98)">=</span> SchemaError(
<span class="ansi-green-fg ansi-bold">    171</span>                 schema,
<span class="ansi-green-fg ansi-bold">    172</span>                 data<span style="color:rgb(98,98,98)">=</span>check_obj,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    178</span>                 reason_code<span style="color:rgb(98,98,98)">=</span>result<span style="color:rgb(98,98,98)">.</span>reason_code,
<span class="ansi-green-fg ansi-bold">    179</span>             )
<span class="ansi-green-fg">--&gt; 180</span>         <span class="ansi-yellow-bg">error_handler</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">collect_error</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    181</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">validation_type</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">result</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">reason_code</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    182</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">result</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">reason_code</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    183</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">error</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    184</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">result</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">original_exc</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    185</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    187</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> error_handler

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/base/error_handler.py:54</span>, in <span class="ansi-cyan-fg">ErrorHandler.collect_error</span><span class="ansi-blue-fg">(self, error_type, reason_code, schema_error, original_exc)</span>
<span class="ansi-green-fg ansi-bold">     47</span> <span style="font-style:italic;color:rgb(175,0,0)">"""Collect schema error, raising exception if lazy is False.</span>
<span class="ansi-green-fg ansi-bold">     48</span> 
<span class="ansi-green-fg ansi-bold">     49</span> <span style="font-style:italic;color:rgb(175,0,0)">:param error_type: type of error</span>
<span class="ansi-green-fg ansi-bold">     50</span> <span style="font-style:italic;color:rgb(175,0,0)">:param reason_code: string representing reason for error</span>
<span class="ansi-green-fg ansi-bold">     51</span> <span style="font-style:italic;color:rgb(175,0,0)">:param schema_error: ``SchemaError`` object.</span>
<span class="ansi-green-fg ansi-bold">     52</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">     53</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_lazy:
<span class="ansi-green-fg">---&gt; 54</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> schema_error <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">original_exc</span>
<span class="ansi-green-fg ansi-bold">     56</span> <span style="font-style:italic;color:rgb(95,135,135)"># delete data of validated object from SchemaError object to prevent</span>
<span class="ansi-green-fg ansi-bold">     57</span> <span style="font-style:italic;color:rgb(95,135,135)"># storing copies of the validated DataFrame/Series for every</span>
<span class="ansi-green-fg ansi-bold">     58</span> <span style="font-style:italic;color:rgb(95,135,135)"># SchemaError collected.</span>
<span class="ansi-green-fg ansi-bold">     59</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">hasattr</span>(schema_error, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">data</span><span style="color:rgb(175,0,0)">"</span>):

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/container.py:201</span>, in <span class="ansi-cyan-fg">DataFrameSchemaBackend.run_schema_component_checks</span><span class="ansi-blue-fg">(self, check_obj, schema_components, lazy)</span>
<span class="ansi-green-fg ansi-bold">    199</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> schema_component <span style="font-weight:bold;color:rgb(175,0,255)">in</span> schema_components:
<span class="ansi-green-fg ansi-bold">    200</span>     <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 201</span>         result <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">schema_component</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    202</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">True</span>
<span class="ansi-green-fg ansi-bold">    203</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    204</span>         check_passed<span style="color:rgb(98,98,98)">.</span>append(is_table(result))
<span class="ansi-green-fg ansi-bold">    205</span>     <span style="font-weight:bold;color:rgb(0,135,0)">except</span> SchemaError <span style="font-weight:bold;color:rgb(0,135,0)">as</span> err:

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/dataframe/components.py:162</span>, in <span class="ansi-cyan-fg">ComponentSchema.validate</span><span class="ansi-blue-fg">(self, check_obj, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    133</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">validate</span>(
<span class="ansi-green-fg ansi-bold">    134</span>     <span style="color:rgb(0,135,0)">self</span>,
<span class="ansi-green-fg ansi-bold">    135</span>     check_obj,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    142</span> ):
<span class="ansi-green-fg ansi-bold">    143</span>     <span style="font-style:italic;color:rgb(95,135,135)"># pylint: disable=too-many-locals,too-many-branches,too-many-statements</span>
<span class="ansi-green-fg ansi-bold">    144</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""Validate a series or specific column in dataframe.</span>
<span class="ansi-green-fg ansi-bold">    145</span> 
<span class="ansi-green-fg ansi-bold">    146</span> <span style="font-style:italic;color:rgb(175,0,0)">    :check_obj: data object to validate.</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    160</span> 
<span class="ansi-green-fg ansi-bold">    161</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 162</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">get_backend</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    163</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    164</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">schema</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    165</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    166</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    167</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    168</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    169</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    170</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">inplace</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    171</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/components.py:136</span>, in <span class="ansi-cyan-fg">ColumnBackend.validate</span><span class="ansi-blue-fg">(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    132</span>             check_obj <span style="color:rgb(98,98,98)">=</span> validate_column(
<span class="ansi-green-fg ansi-bold">    133</span>                 check_obj, column_name, return_check_obj<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>
<span class="ansi-green-fg ansi-bold">    134</span>             )
<span class="ansi-green-fg ansi-bold">    135</span>         <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 136</span>             <span class="ansi-yellow-bg">validate_column</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">column_name</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    138</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> lazy <span style="font-weight:bold;color:rgb(175,0,255)">and</span> error_handler<span style="color:rgb(98,98,98)">.</span>collected_errors:
<span class="ansi-green-fg ansi-bold">    139</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> SchemaErrors(
<span class="ansi-green-fg ansi-bold">    140</span>         schema<span style="color:rgb(98,98,98)">=</span>schema,
<span class="ansi-green-fg ansi-bold">    141</span>         schema_errors<span style="color:rgb(98,98,98)">=</span>error_handler<span style="color:rgb(98,98,98)">.</span>schema_errors,
<span class="ansi-green-fg ansi-bold">    142</span>         data<span style="color:rgb(98,98,98)">=</span>check_obj,
<span class="ansi-green-fg ansi-bold">    143</span>     )

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/components.py:92</span>, in <span class="ansi-cyan-fg">ColumnBackend.validate.&lt;locals&gt;.validate_column</span><span class="ansi-blue-fg">(check_obj, column_name, return_check_obj)</span>
<span class="ansi-green-fg ansi-bold">     88</span>         error_handler<span style="color:rgb(98,98,98)">.</span>collect_error(
<span class="ansi-green-fg ansi-bold">     89</span>             validation_type(err<span style="color:rgb(98,98,98)">.</span>reason_code), err<span style="color:rgb(98,98,98)">.</span>reason_code, err
<span class="ansi-green-fg ansi-bold">     90</span>         )
<span class="ansi-green-fg ansi-bold">     91</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> SchemaError <span style="font-weight:bold;color:rgb(0,135,0)">as</span> err:
<span class="ansi-green-fg">---&gt; 92</span>     <span class="ansi-yellow-bg">error_handler</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">collect_error</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">     93</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">validation_type</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">err</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">reason_code</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">err</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">reason_code</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">err</span>
<span class="ansi-green-fg ansi-bold">     94</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/base/error_handler.py:54</span>, in <span class="ansi-cyan-fg">ErrorHandler.collect_error</span><span class="ansi-blue-fg">(self, error_type, reason_code, schema_error, original_exc)</span>
<span class="ansi-green-fg ansi-bold">     47</span> <span style="font-style:italic;color:rgb(175,0,0)">"""Collect schema error, raising exception if lazy is False.</span>
<span class="ansi-green-fg ansi-bold">     48</span> 
<span class="ansi-green-fg ansi-bold">     49</span> <span style="font-style:italic;color:rgb(175,0,0)">:param error_type: type of error</span>
<span class="ansi-green-fg ansi-bold">     50</span> <span style="font-style:italic;color:rgb(175,0,0)">:param reason_code: string representing reason for error</span>
<span class="ansi-green-fg ansi-bold">     51</span> <span style="font-style:italic;color:rgb(175,0,0)">:param schema_error: ``SchemaError`` object.</span>
<span class="ansi-green-fg ansi-bold">     52</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">     53</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_lazy:
<span class="ansi-green-fg">---&gt; 54</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> schema_error <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">original_exc</span>
<span class="ansi-green-fg ansi-bold">     56</span> <span style="font-style:italic;color:rgb(95,135,135)"># delete data of validated object from SchemaError object to prevent</span>
<span class="ansi-green-fg ansi-bold">     57</span> <span style="font-style:italic;color:rgb(95,135,135)"># storing copies of the validated DataFrame/Series for every</span>
<span class="ansi-green-fg ansi-bold">     58</span> <span style="font-style:italic;color:rgb(95,135,135)"># SchemaError collected.</span>
<span class="ansi-green-fg ansi-bold">     59</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">hasattr</span>(schema_error, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">data</span><span style="color:rgb(175,0,0)">"</span>):

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/components.py:72</span>, in <span class="ansi-cyan-fg">ColumnBackend.validate.&lt;locals&gt;.validate_column</span><span class="ansi-blue-fg">(check_obj, column_name, return_check_obj)</span>
<span class="ansi-green-fg ansi-bold">     69</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">validate_column</span>(check_obj, column_name, return_check_obj<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">False</span>):
<span class="ansi-green-fg ansi-bold">     70</span>     <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg ansi-bold">     71</span>         <span style="font-style:italic;color:rgb(95,135,135)"># pylint: disable=super-with-arguments</span>
<span class="ansi-green-fg">---&gt; 72</span>         validated_check_obj <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">super</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ColumnBackend</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">     73</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     74</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">deepcopy</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">schema</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">set_name</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">column_name</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     75</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     76</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     77</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     78</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     79</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     80</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">inplace</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     81</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     83</span>         <span style="font-weight:bold;color:rgb(0,135,0)">if</span> return_check_obj:
<span class="ansi-green-fg ansi-bold">     84</span>             <span style="font-weight:bold;color:rgb(0,135,0)">return</span> validated_check_obj

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/array.py:81</span>, in <span class="ansi-cyan-fg">ArraySchemaBackend.validate</span><span class="ansi-blue-fg">(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">     75</span> check_obj <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>run_parsers(
<span class="ansi-green-fg ansi-bold">     76</span>     schema,
<span class="ansi-green-fg ansi-bold">     77</span>     check_obj,
<span class="ansi-green-fg ansi-bold">     78</span> )
<span class="ansi-green-fg ansi-bold">     80</span> <span style="font-style:italic;color:rgb(95,135,135)"># run the core checks</span>
<span class="ansi-green-fg">---&gt; 81</span> error_handler <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">run_checks_and_handle_errors</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">     82</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">error_handler</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     83</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">schema</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     84</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     85</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     86</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     87</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     88</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">     89</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     91</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> lazy <span style="font-weight:bold;color:rgb(175,0,255)">and</span> error_handler<span style="color:rgb(98,98,98)">.</span>collected_errors:
<span class="ansi-green-fg ansi-bold">     92</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">getattr</span>(schema, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">drop_invalid_rows</span><span style="color:rgb(175,0,0)">"</span>, <span style="font-weight:bold;color:rgb(0,135,0)">False</span>):

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/array.py:145</span>, in <span class="ansi-cyan-fg">ArraySchemaBackend.run_checks_and_handle_errors</span><span class="ansi-blue-fg">(self, error_handler, schema, check_obj, **subsample_kwargs)</span>
<span class="ansi-green-fg ansi-bold">    134</span>         <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg ansi-bold">    135</span>             error <span style="color:rgb(98,98,98)">=</span> SchemaError(
<span class="ansi-green-fg ansi-bold">    136</span>                 schema<span style="color:rgb(98,98,98)">=</span>schema,
<span class="ansi-green-fg ansi-bold">    137</span>                 data<span style="color:rgb(98,98,98)">=</span>check_obj,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    143</span>                 reason_code<span style="color:rgb(98,98,98)">=</span>result<span style="color:rgb(98,98,98)">.</span>reason_code,
<span class="ansi-green-fg ansi-bold">    144</span>             )
<span class="ansi-green-fg">--&gt; 145</span>             <span class="ansi-yellow-bg">error_handler</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">collect_error</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    146</span> <span class="ansi-yellow-bg">                </span><span class="ansi-yellow-bg">validation_type</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">result</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">reason_code</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    147</span> <span class="ansi-yellow-bg">                </span><span class="ansi-yellow-bg">result</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">reason_code</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    148</span> <span class="ansi-yellow-bg">                </span><span class="ansi-yellow-bg">error</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    149</span> <span class="ansi-yellow-bg">                </span><span class="ansi-yellow-bg">original_exc</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">result</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">original_exc</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    150</span> <span class="ansi-yellow-bg">            </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    152</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> error_handler

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/base/error_handler.py:54</span>, in <span class="ansi-cyan-fg">ErrorHandler.collect_error</span><span class="ansi-blue-fg">(self, error_type, reason_code, schema_error, original_exc)</span>
<span class="ansi-green-fg ansi-bold">     47</span> <span style="font-style:italic;color:rgb(175,0,0)">"""Collect schema error, raising exception if lazy is False.</span>
<span class="ansi-green-fg ansi-bold">     48</span> 
<span class="ansi-green-fg ansi-bold">     49</span> <span style="font-style:italic;color:rgb(175,0,0)">:param error_type: type of error</span>
<span class="ansi-green-fg ansi-bold">     50</span> <span style="font-style:italic;color:rgb(175,0,0)">:param reason_code: string representing reason for error</span>
<span class="ansi-green-fg ansi-bold">     51</span> <span style="font-style:italic;color:rgb(175,0,0)">:param schema_error: ``SchemaError`` object.</span>
<span class="ansi-green-fg ansi-bold">     52</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">     53</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_lazy:
<span class="ansi-green-fg">---&gt; 54</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> schema_error <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">original_exc</span>
<span class="ansi-green-fg ansi-bold">     56</span> <span style="font-style:italic;color:rgb(95,135,135)"># delete data of validated object from SchemaError object to prevent</span>
<span class="ansi-green-fg ansi-bold">     57</span> <span style="font-style:italic;color:rgb(95,135,135)"># storing copies of the validated DataFrame/Series for every</span>
<span class="ansi-green-fg ansi-bold">     58</span> <span style="font-style:italic;color:rgb(95,135,135)"># SchemaError collected.</span>
<span class="ansi-green-fg ansi-bold">     59</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">hasattr</span>(schema_error, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">data</span><span style="color:rgb(175,0,0)">"</span>):

<span class="ansi-red-fg">SchemaError</span>: Column 'class' failed element-wise validator number 0: isin(['Benign', 'Malignant']) failure cases: benign</pre>
</div>
</div>
</div>
<p>Wow, that‚Äôs a lot, but what is clear is that an error was thrown. If we read through the error message to the end we see the important, and useful piece of the error message:</p>
<pre><code>pandera.errors.SchemaError: Column 'class' failed element-wise validator number 0: isin(['Benign', 'Malignant']) failure cases: benign</code></pre>
<p>The error arose because in our <code>invalid_data</code>, the column <code>class</code> contained the string <code>"benign"</code>, and we specified in our <code>pa.DataFrameSchema</code> instance that we only accept two string values in the <code>class</code> column, <code>"Benign"</code> and <code>"Malignant"</code>.</p>
<p>What about the other errors we expect from our invalid data? For example, we there‚Äôs a value of <code>-9999</code> in the <code>mean_radius</code> column that is well outside of the range we said was valid in the schema (5, 45), and we have a duplicate row as well? Why are these validation errors not reported? Pandera‚Äôs default is to throw an error after the first instance of non-valid data. To change this behaviour, we can set <code>lazy=True</code>. When we do this we see that all errors get reported.</p>
<div id="09b93b86" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>schema.validate(invalid_data, lazy<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">SchemaErrors</span>                              Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">schema</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">invalid_data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">True</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/pandas/container.py:126</span>, in <span class="ansi-cyan-fg">DataFrameSchema.validate</span><span class="ansi-blue-fg">(self, check_obj, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    114</span>     check_obj <span style="color:rgb(98,98,98)">=</span> check_obj<span style="color:rgb(98,98,98)">.</span>map_partitions(  <span style="font-style:italic;color:rgb(95,135,135)"># type: ignore [operator]</span>
<span class="ansi-green-fg ansi-bold">    115</span>         <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_validate,
<span class="ansi-green-fg ansi-bold">    116</span>         head<span style="color:rgb(98,98,98)">=</span>head,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    122</span>         meta<span style="color:rgb(98,98,98)">=</span>check_obj,
<span class="ansi-green-fg ansi-bold">    123</span>     )
<span class="ansi-green-fg ansi-bold">    124</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> check_obj<span style="color:rgb(98,98,98)">.</span>pandera<span style="color:rgb(98,98,98)">.</span>add_schema(<span style="color:rgb(0,135,0)">self</span>)
<span class="ansi-green-fg">--&gt; 126</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    127</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">check_obj</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    128</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    129</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    130</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    131</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    132</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    133</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">inplace</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    134</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/api/pandas/container.py:156</span>, in <span class="ansi-cyan-fg">DataFrameSchema._validate</span><span class="ansi-blue-fg">(self, check_obj, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    147</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_is_inferred:
<span class="ansi-green-fg ansi-bold">    148</span>     warnings<span style="color:rgb(98,98,98)">.</span>warn(
<span class="ansi-green-fg ansi-bold">    149</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">This </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span style="color:rgb(0,135,0)">type</span>(<span style="color:rgb(0,135,0)">self</span>)<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)"> is an inferred schema that hasn</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">t been </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    150</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">modified. It</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">s recommended that you refine the schema </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    153</span>         <span style="font-weight:bold;color:rgb(215,95,95)">UserWarning</span>,
<span class="ansi-green-fg ansi-bold">    154</span>     )
<span class="ansi-green-fg">--&gt; 156</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">get_backend</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    157</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">check_obj</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    158</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">schema</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    159</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">head</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">head</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    160</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tail</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tail</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    161</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">sample</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">sample</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    162</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_state</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    163</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">lazy</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">lazy</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    164</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">inplace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">inplace</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    165</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandera/backends/pandas/container.py:123</span>, in <span class="ansi-cyan-fg">DataFrameSchemaBackend.validate</span><span class="ansi-blue-fg">(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)</span>
<span class="ansi-green-fg ansi-bold">    121</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> check_obj
<span class="ansi-green-fg ansi-bold">    122</span>     <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 123</span>         <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> SchemaErrors(
<span class="ansi-green-fg ansi-bold">    124</span>             schema<span style="color:rgb(98,98,98)">=</span>schema,
<span class="ansi-green-fg ansi-bold">    125</span>             schema_errors<span style="color:rgb(98,98,98)">=</span>error_handler<span style="color:rgb(98,98,98)">.</span>schema_errors,
<span class="ansi-green-fg ansi-bold">    126</span>             data<span style="color:rgb(98,98,98)">=</span>check_obj,
<span class="ansi-green-fg ansi-bold">    127</span>         )
<span class="ansi-green-fg ansi-bold">    129</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> check_obj

<span class="ansi-red-fg">SchemaErrors</span>: {
    "DATA": {
        "DATAFRAME_CHECK": [
            {
                "schema": null,
                "column": "class",
                "check": "isin(['Benign', 'Malignant'])",
                "error": "Column 'class' failed element-wise validator number 0: isin(['Benign', 'Malignant']) failure cases: benign"
            },
            {
                "schema": null,
                "column": "mean_radius",
                "check": "in_range(5, 45)",
                "error": "Column 'mean_radius' failed element-wise validator number 0: in_range(5, 45) failure cases: -9999.0"
            },
            {
                "schema": null,
                "column": null,
                "check": "Duplicate rows found.",
                "error": "DataFrameSchema 'None' failed series or dataframe validator 0: &lt;Check &lt;lambda&gt;: Duplicate rows found.&gt;"
            }
        ]
    }
}</pre>
</div>
</div>
</div>
</section>
<section id="handling-invalid-data" class="level3" data-number="13.4.4">
<h3 data-number="13.4.4" class="anchored" data-anchor-id="handling-invalid-data"><span class="header-section-number">13.4.4</span> Handling invalid data</h3>
<p>By default Pandera will throw an error when a check is not passed. Depending on your situation, this can be a desired expected behaviour (e.g., a static data analysis published in a report) or a very undesired behaviour that could potentially be dangerous (e.g., autonomous driving application). In the latter case, we would want to do something different than throw an error. Possibilities we will cover here include dropping invalid observations and writing log files that report the errors.</p>
</section>
<section id="dropping-invalid-observations" class="level3" data-number="13.4.5">
<h3 data-number="13.4.5" class="anchored" data-anchor-id="dropping-invalid-observations"><span class="header-section-number">13.4.5</span> Dropping invalid observations</h3>
<p>In an in-production system, dropping non-valid data could be a reasonable path forward instead of throwing an error. Another situation where this might be a reasonable thing to do is when training a machine learning model with a million observations. You don‚Äôt want to throw an error in the middle of training if only one observation is invalid!</p>
<p>To change the behaviour of <code>pa.DataFrameSchema.validate</code> to instead return a dataframe with the invalid rows dropped we need to do two things:</p>
<ol type="1">
<li>add <code>drop_invalid_rows=True</code> to our <code>pa.DataFrameSchema</code> instance</li>
<li>add <code>lazy=True</code> to our call to the <code>pa.DataFrameSchema.validate</code> method</li>
</ol>
<p>Below we demonstrate this with our working example.</p>
<div id="2398f291" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>, pa.Check.isin([<span class="st">"Benign"</span>, <span class="st">"Malignant"</span>]), nullable<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, pa.Check.between(<span class="dv">5</span>, <span class="dv">45</span>), nullable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    checks<span class="op">=</span>[</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>df.duplicated().<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Duplicate rows found."</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>(df.isna().<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)).<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Empty rows found."</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    drop_invalid_rows<span class="op">=</span><span class="va">True</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>schema.validate(invalid_data, lazy<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">mean_radius</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Benign</td>
<td>6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Benign</td>
<td>6.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Hmmm‚Ä¶ Why did the duplicate row sneak through? This is because Pandera‚Äôs dropping rows only works on data, or column, checks, not the DataFrame-wide checks like our checks for duplicates or empty rows. Thus to make sure we drop these, we need to rely on Pandas to do this. We demonstrate how we can do this below:</p>
<div id="6c7d0e5a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>schema.validate(invalid_data, lazy<span class="op">=</span><span class="va">True</span>).drop_duplicates().dropna(how<span class="op">=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">mean_radius</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Benign</td>
<td>6.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="writing-data-validation-logs" class="level3" data-number="13.4.6">
<h3 data-number="13.4.6" class="anchored" data-anchor-id="writing-data-validation-logs"><span class="header-section-number">13.4.6</span> Writing data validation logs</h3>
<p>Is removing the rows sufficient? Not at all! A human should be told that there was invalid data so that upstream data collection, cleaning and transformation processes can be reviewed to minimize the chances of future invalid data. One way to do this is to again specify <code>lazy=True</code> so that all errors can be observed and reported. Then we can get the <code>SchemaErrors</code> and write them to a log file. We show below how to do this for our working example so that the valid rows are returned as a dataframe named <code>validated_data</code> and the errors are logged as a file called <code>validation_errors.log</code>:</p>
<div id="f95d93ba" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandera <span class="im">as</span> pa</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandera <span class="im">import</span> Check</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure logging</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"validation_errors.log"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    filemode<span class="op">=</span><span class="st">"w"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span>logging.INFO,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the schema</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.DataFrameSchema(</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span>: pa.Column(<span class="bu">str</span>, pa.Check.isin([<span class="st">"Benign"</span>, <span class="st">"Malignant"</span>]), nullable<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_radius"</span>: pa.Column(<span class="bu">float</span>, pa.Check.between(<span class="dv">5</span>, <span class="dv">45</span>), nullable<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    checks<span class="op">=</span>[</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>df.duplicated().<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Duplicate rows found."</span>),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        pa.Check(<span class="kw">lambda</span> df: <span class="op">~</span>(df.isna().<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)).<span class="bu">any</span>(), error<span class="op">=</span><span class="st">"Empty rows found."</span>),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    drop_invalid_rows<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize error cases DataFrame</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>error_cases <span class="op">=</span> pd.DataFrame()</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> invalid_data.copy()</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate data and handle errors</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    validated_data <span class="op">=</span> schema.validate(data, lazy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> pa.errors.SchemaErrors <span class="im">as</span> e:</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    error_cases <span class="op">=</span> e.failure_cases</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the error message to a JSON string</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    error_message <span class="op">=</span> json.dumps(e.message, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    logging.error(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> error_message)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out invalid rows based on the error cases</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> error_cases.empty:</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    invalid_indices <span class="op">=</span> error_cases[<span class="st">"index"</span>].dropna().unique()</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    validated_data <span class="op">=</span> (</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        data.drop(index<span class="op">=</span>invalid_indices)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>        .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>        .drop_duplicates()</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>        .dropna(how<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    validated_data <span class="op">=</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="the-data-validation-ecosystem" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="the-data-validation-ecosystem"><span class="header-section-number">13.5</span> The data validation ecosystem</h2>
<p>We have given a tour of one of the packages in the data validation ecosystem, however there are a few others that are good to know about. We list the others below:</p>
<p><strong>Python:</strong></p>
<ul>
<li>Deep Checks: <a href="https://docs.deepchecks.com" class="uri">https://docs.deepchecks.com</a></li>
<li>Great Expectation: <a href="https://docs.greatexpectations.io" class="uri">https://docs.greatexpectations.io</a></li>
<li>Pandera: <a href="https://pandera.readthedocs.io" class="uri">https://pandera.readthedocs.io</a></li>
<li>Pydantic: <a href="https://docs.pydantic.dev/latest/" class="uri">https://docs.pydantic.dev/latest/</a></li>
</ul>
<p><strong>R</strong></p>
<ul>
<li>pointblank: <a href="https://rstudio.github.io/pointblank" class="uri">https://rstudio.github.io/pointblank</a></li>
</ul>
<section id="deep-checks" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="deep-checks"><span class="header-section-number">13.5.1</span> Deep Checks</h3>
<p>In particular, the <a href="https://docs.deepchecks.com">Deep Checks</a> package is quite useful due to it‚Äôs high-level abstraction of several machine learning data validation checks that you would have to code manually if you chose to use something like <code>Pandera</code> for these. Examples from the checklist above include:</p>
<ul class="task-list">
<li><label><input type="checkbox">No anomalous correlations between target/response variable and features/explanatory variables<sup>1</sup></label></li>
<li><label><input type="checkbox">No anomalous correlations between features/explanatory variables<sup>1</sup></label></li>
</ul>
<p>To use this, we first have to create a Deep Checks Dataset object (specifying the data set, the target/response variable, and any categorical features):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> deepchecks.tabular <span class="im">import</span> Dataset</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>cancer_train_ds <span class="op">=</span> Dataset(cancer_train, label<span class="op">=</span><span class="st">"class"</span>, cat_features<span class="op">=</span>[])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once we have that, we can use the <code>FeatureLabelCorrelation()</code> check set the maximum threshold we‚Äôll allow (here 0.9), and run the check:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> deepchecks.tabular.checks <span class="im">import</span> FeatureLabelCorrelation</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>check_feat_lab_corr <span class="op">=</span> FeatureLabelCorrelation().add_condition_feature_pps_less_than(<span class="fl">0.9</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>check_feat_lab_corr_result <span class="op">=</span> check_feat_lab_corr.run(dataset<span class="op">=</span>cancer_train_ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Finally, we can check if the result of the <code>FeatureLabelCorrelation()</code> validation has failed. If it has (i.e., correlation is above the acceptable threshold), we can do something, like raise a ValueError with an appropriate error message:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> check_feat_lab_corr_result.passed_conditions():</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Feature-Label correlation exceeds the maximum acceptable threshold."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice above the name of the data frame and Deep checks data set? It has the word ‚Äútrain‚Äù in it. This is important! Some data validation checks can cause data leakage if we perform them on the entire data set before finalizing feature and model selection. Be conscientious about your data validation checks to ensure they do not data introduce leakage.</p>
</div>
</div>
<p>Deep Checks has a nice gallery of different data validation checks for which it has high-level functions: <a href="https://docs.deepchecks.com/stable/tabular/auto_checks/data_integrity/index.html" class="uri">https://docs.deepchecks.com/stable/tabular/auto_checks/data_integrity/index.html</a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../parts/data-testing.html" class="pagination-link" aria-label="Data Validation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Data Validation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lectures/140-intro-to-testing-code.html" class="pagination-link" aria-label="Introduction to testing code for data science">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction to testing code for data science</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>